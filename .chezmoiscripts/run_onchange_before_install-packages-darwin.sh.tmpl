{{- if eq .chezmoi.os "darwin" -}}
#!/bin/bash
set -e

echo "üçé Installing packages for macOS..."

# Install Homebrew if missing
if ! command -v brew &> /dev/null; then
  echo "Installing Homebrew..."
  /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
  eval "$(/opt/homebrew/bin/brew shellenv)"
fi

# Install packages from Brewfile
if [ -f ~/.config/Brewfile ]; then
  echo "Installing from Brewfile..."
  brew bundle --file=~/.config/Brewfile
else
  echo "‚ö†Ô∏è  No Brewfile found at ~/.config/Brewfile"
fi

# TPM (Tmux Plugin Manager)
if [ ! -d "$HOME/.tmux/plugins/tpm" ]; then
  echo "Installing TPM..."
  git clone https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm
fi

# Oh-My-Zsh
if [ ! -d "$HOME/.oh-my-zsh" ]; then
  echo "Installing Oh-My-Zsh..."
  sh -c "$(curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)" "" --unattended
fi

echo "‚úÖ macOS packages installed!"
{{- end -}}
